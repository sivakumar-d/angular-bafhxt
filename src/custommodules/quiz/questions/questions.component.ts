import { Component, OnInit } from '@angular/core';
import { DomSanitizer, SafeResourceUrl } from '@angular/platform-browser';
import {QuestionsService} from '../../../services/questions.service';
import {Questions} from './questions.model';

@Component({
  selector: 'questions',
  templateUrl: './questions.component.html',
  styleUrls: ['./questions.component.css']
})
export class QuestionsComponent implements OnInit {
  correctCount = 0;
  currentQuestion = 0;
  progressValue = 0;
  questionCount;
  questions$;
  selectedOption;
  CONGRATULATIONS = 'assets/img/congratulations.jpg';
  TRY_AGAIN = 'assets/img/try-again.png';
  Header_Image:SafeResourceUrl;
  Header_Image1 :string;

  // image urls overridden by Data URLs in constructor for stackblitz workaround
  constructor(private QuestionsService: QuestionsService,public sanitizer: DomSanitizer) {
    this.CONGRATULATIONS = 'Completed';
    this.Header_Image1 = 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4xLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHZpZXdCb3g9IjAgMCAxNzcgMzQuOSIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTc3IDM0LjkiIHhtbDpzcGFjZT0icHJlc2VydmUiPg0KPGc+DQoJPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGZpbGw9IiMwMDdBQkQiIGQ9Ik02NSw5LjFjLTcuOCwwLTE0LjEsNS44LTE0LjEsMTIuOWMwLDcuMSw2LjMsMTIuOSwxNC4xLDEyLjkNCgkJQzcyLjcsMzQuOSw3OSwyOS4xLDc5LDIyQzc5LDE0LjksNzIuNyw5LjEsNjUsOS4xeiBNNjUsMjUuNGMtMS43LDAtMy4xLTEuNS0zLjEtMy40YzAtMS45LDEuNC0zLjQsMy4xLTMuNGMxLjcsMCwzLjEsMS42LDMuMSwzLjQNCgkJQzY4LDIzLjksNjYuNywyNS40LDY1LDI1LjR6IE0xMTUuNyw5LjJjLTcuNywwLTE0LjEsNS44LTE0LjEsMTIuOWMwLDcuMSw2LjMsMTIuOSwxNC4xLDEyLjljNy44LDAsMTQuMS01LjgsMTQuMS0xMi45DQoJCUMxMjkuNywxNC45LDEyMy40LDkuMiwxMTUuNyw5LjJ6IE0xMTUuNywyNS41Yy0xLjcsMC0zLjEtMS41LTMuMS0zLjRjMC0xLjksMS40LTMuNCwzLjEtMy40YzEuNywwLDMuMSwxLjUsMy4xLDMuNA0KCQlDMTE4LjcsMjMuOSwxMTcuNCwyNS41LDExNS43LDI1LjV6IE05My40LDkuMWMyLjQsMCw0LjcsMC43LDYuNywxLjl2OS41Yy0xLjEtMS4xLTMuMS0xLjgtNC4yLTEuOGMtMS42LDAtNCwxLjUtNCwzLjQNCgkJYzAsMS45LDIuNCwzLjQsNCwzLjRjMS4xLDAsMy0wLjcsNC4yLTEuOFYzM2MtMiwxLjItNC4zLDEuOS02LjcsMS45Yy03LjIsMC0xMy01LjgtMTMtMTIuOUM4MC40LDE0LjksODYuMiw5LjEsOTMuNCw5LjF6DQoJCSBNMTcxLjQsMTUuOHYxOC42aC0xMC45VjIwLjVjMC4yLTIuOS0zLjYtMi43LTMuNiwwdjEzLjloLTExLjFWMjAuNWMtMC4yLTIuMi0yLjUtMi40LTMuNC0wLjZ2MTQuM2gtMTEuM1YxMC40aDExLjN2My4xDQoJCWM0LjMtNi4yLDExLjEtNC42LDEzLjcsMC41YzQuOC02LjQsMTIuNS01LjUsMTQuNywwTDE3MS40LDE1Ljh6IE01MCw5LjV2MTEuNmMtMS42LTEtNi43LTIuNy04LjEsMi43djEwLjVIMzAuNlYxMC40aDExLjF2My40DQoJCUM0NC4xLDEwLjcsNDcuNiw5LjQsNTAsOS41eiBNMCwzMi41aDEyLjN2MS44SDBWMzIuNXogTTAsMjkuM2gxMi4zdjEuN0gwVjI5LjN6IE0wLDI2LjJoMTIuM1YyOEgwVjI2LjJ6IE0xMi4xLDExLjZIMFY5LjdoMTIuMQ0KCQlWMTEuNnogTTEyLjEsMTQuOEgwdi0xLjloMTIuMVYxNC44eiBNMCwyMi45aDIyLjZjLTEuOCwxLjYtMTAsMS44LTEwLjksMS44SDBWMjIuOXogTTIyLjYsMS44SDBWMGgxMS43YzAuOC0wLjEsNy44LDAuMSwxMC40LDEuNA0KCQlDMjIuMiwxLjUsMjIuNCwxLjYsMjIuNiwxLjhDMjIuNiwxLjcsMjIuNiwxLjcsMjIuNiwxLjh6IE0yNi4zLDVMMCw1LjFWMy4zbDI0LjYtMC4xQzI1LjIsMy44LDI1LjgsNC40LDI2LjMsNXogTTI4LjEsOC40SDBWNi41DQoJCWgyNy4zQzI3LjYsNy4xLDI3LjksNy43LDI4LjEsOC40eiBNMTYuNCw5LjdoMTIuMmMwLjIsMC42LDAuMiwxLjIsMC4zLDEuOWgtMTFDMTcuNywxMSwxNy42LDEwLjIsMTYuNCw5Ljd6IE0xNy45LDEyLjlsMTEsMA0KCQljMCwwLjYtMC4xLDEuMy0wLjIsMS45bC0xMi4xLDBDMTcuMiwxNC42LDE3LjgsMTQsMTcuOSwxMi45eiBNMCwxNi41aDI4LjFjLTAuMiwwLjctMC42LDEuMy0wLjksMS45SDBWMTYuNXogTTAsMTkuN2wyNi4zLDANCgkJYy0wLjUsMC43LTEuMSwxLjItMS43LDEuOEwwLDIxLjRWMTkuN3ogTTE3NywxMS45YzAsMC4yLDAsMC40LTAuMSwwLjZjLTAuMSwwLjItMC4yLDAuMy0wLjMsMC41Yy0wLjIsMC4xLTAuMywwLjItMC41LDAuMw0KCQljLTAuMiwwLjEtMC40LDAuMS0wLjYsMC4xdi0wLjNjMC4yLDAsMC4zLDAsMC41LTAuMWMwLjEtMC4xLDAuMy0wLjEsMC40LTAuM2MwLjEtMC4xLDAuMi0wLjIsMC4yLTAuNGMwLjEtMC4xLDAuMS0wLjMsMC4xLTAuNQ0KCQljMC0wLjIsMC0wLjQtMC4xLTAuNWMtMC4xLTAuMi0wLjItMC4zLTAuMi0wLjRjLTAuMS0wLjEtMC4yLTAuMi0wLjQtMC4yYy0wLjIsMC0wLjMtMC4xLTAuNS0wLjFsMCwwdi0wLjNsMCwwYzAuMiwwLDAuNCwwLDAuNiwwLjENCgkJYzAuMiwwLjEsMC4zLDAuMiwwLjUsMC4zYzAuMSwwLjEsMC4yLDAuMywwLjMsMC41QzE3NywxMS41LDE3NywxMS43LDE3NywxMS45TDE3NywxMS45eiBNMTc1LjQsMTIuMQ0KCQlDMTc1LjUsMTIuMSwxNzUuNSwxMi4xLDE3NS40LDEyLjFjMC4xLDAuMSwwLjEsMC4xLDAuMiwwLjJsMC4xLDAuM2MwLDAsMCwwLjEsMCwwLjFjMCwwLDAsMCwwLjEsMGMwLDAsMCwwLDAuMSwwYzAsMCwwLjEsMCwwLjEsMA0KCQljMCwwLDAuMSwwLDAuMSwwYzAsMCwwLDAsMC4xLDBjMCwwLDAsMCwwLDBjMCwwLDAsMCwwLDBjMCwwLDAsMCwwLTAuMWwtMC4xLTAuMmMtMC4xLTAuMS0wLjEtMC4yLTAuMi0wLjJjLTAuMSwwLTAuMS0wLjEtMC4yLTAuMQ0KCQljMC4xLDAsMC4yLTAuMSwwLjMtMC4xYzAuMS0wLjEsMC4xLTAuMiwwLjEtMC4zYzAtMC4xLDAtMC4xLDAtMC4yYzAtMC4xLTAuMS0wLjEtMC4xLTAuMmMtMC4xLDAtMC4xLTAuMS0wLjItMC4xDQoJCWMtMC4xLDAtMC4yLDAtMC4zLDBsMCwwdjAuM2MwLDAsMC4xLDAsMC4xLDBjMC4xLDAsMC4xLDAsMC4xLDBjMCwwLDAsMCwwLDAuMWMwLDAsMCwwLDAsMC4xYzAsMC4xLDAsMC4xLTAuMSwwLjINCgkJYzAsMC0wLjEsMC0wLjIsMC4xVjEyLjF6IE0xNzUuNCwxMy41TDE3NS40LDEzLjVjLTAuMiwwLTAuNSwwLTAuNi0wLjFjLTAuMi0wLjEtMC4zLTAuMi0wLjUtMC4zYy0wLjEtMC4xLTAuMi0wLjMtMC4zLTAuNQ0KCQljLTAuMS0wLjItMC4xLTAuNC0wLjEtMC42YzAtMC4yLDAtMC40LDAuMS0wLjZjMC4xLTAuMiwwLjItMC40LDAuMy0wLjVjMC4yLTAuMSwwLjMtMC4yLDAuNS0wLjNjMC4yLTAuMSwwLjQtMC4xLDAuNi0wLjF2MC4zDQoJCWMtMC4yLDAtMC4zLDAtMC41LDAuMWMtMC4yLDAuMS0wLjMsMC4yLTAuNCwwLjNjLTAuMSwwLjEtMC4yLDAuMi0wLjIsMC40Yy0wLjEsMC4xLTAuMSwwLjMtMC4xLDAuNWMwLDAuMiwwLDAuNCwwLjEsMC41DQoJCWMwLjEsMC4yLDAuMiwwLjMsMC4yLDAuNGMwLjEsMC4xLDAuMiwwLjIsMC40LDAuM2MwLjEsMCwwLjMsMC4xLDAuNSwwLjFsMCwwVjEzLjVMMTc1LjQsMTMuNXogTTE3NS40LDExSDE3NWMtMC4xLDAtMC4xLDAtMC4xLDANCgkJYzAsMCwwLDAuMSwwLDAuMXYxLjRjMCwwLDAsMCwwLDBjMCwwLDAuMSwwLDAuMiwwYzAuMSwwLDAuMSwwLDAuMiwwYzAsMCwwLDAsMCwwdi0wLjZoMC4xYzAsMCwwLjEsMCwwLjEsMHYtMC4zYzAsMCwwLDAtMC4xLDANCgkJaC0wLjJ2LTAuNGgwLjJjMCwwLDAsMCwwLjEsMFYxMXoiLz4NCjwvZz4NCjwvc3ZnPg0K';
  }

  ngOnInit() {
    
    this.questions$ = this.QuestionsService.getQuestions();
    this.questions$.subscribe((questions: Questions[]) => {
        this.questionCount = questions['quiz-questions'].length;
        this.progressValue = 100 * (this.currentQuestion + 1) / this.questionCount;
    });
  }Questions

  nextQuestion(answer: number) {
    if (answer === this.selectedOption) {this.correctCount++; }
    delete this.selectedOption;
    this.currentQuestion++;
    this.progressValue = 100 * (this.currentQuestion + 1) / this.questionCount;
  }
}
